# UBCONFIG
# Перехвачик данных 

## 1. Назначение

Компонент перехватывает данные со сценариев Sh исполнаемые на серверы и внедряют их в код шаблона.

## 2. Задачи

* Определение дополнительных правил оформление шаблона
* Идентификация набора скриптов для исполнение
* Исполнение и структурированое хранение данных со сценариев
* Анализ шаблона на придмет запрашиваемых данных
* Возможность передачи в шаблон как одиночных, так и множественных выбор данных со сценариев

## 3. Правила оформления шаблона и режимы обработки

### 3.1 Основные положения

В шаблоне указывать места для вставки данных со скриптов нужно в формате \``Имя скрипта(управляющий символ)(параметры)``.
Имя скрипта представляет из себя исполнительныую инструкция как в командной строке, которая считывается полностью до управляющего символа. Управляющий символ `@` разделяет имя скрипта и его парметры.


Параметры - это числовые значение, которые конкретизируют выборку. Также в шаблоне для указание конструкций разметки, которые необходимо повторить обромляются в символ `&` всего поддерживается один уровень вложенности таких конструкций. Наличее вложености также является параметром обработки данных со сценнариев.

### 3.2 Режимы обработки

Как описанно выше режимы обработки складываются из двух параметров 

* Параметры выборки (до двух)
* Наличие обромленных конструкций(до двух)(далле просто обр.)

При отсутвие параметров

* 0 обр - будет возвращен результат только первой ответной транзакций с прямой заменой. 
* 1 обр - будут возвращены результаты всех ответных транзакций с дубрирование обр. .

При наличие одного параметра N

* 0 обр - будет возвращен только N транзакзия с прямой заменой.
* 1 обр - будут возвращены все транзакции от 0 до N с дубрирование обр. .
* 2 обр - будет возвращен все транзакции с дубрирование обр.(1), но через каждую N транзакцию дублируется обр.(2)  .

При наличие двух параметров N,V

* 1 обр - будет возвращен диапозон N...V транзакзий с дубрирование обр. .
* 2 обр - будет возвращен все транзакции до V с дубрирование обр.(1), но через каждую N транзакцию дублируется обр.(2)  .

## 4. Функционнальные единицы

### 4.1 Анализ исполнения

* Вход: Код шаблона
* Выход: Массив с набором исполняемых комад или скриптов

Читает файл шаблона, находит признак вставки данных со скриптов, заносит в массив и проверяет его на уникальность данных.

### 4.2 Исполнение сценариев

* Вход: Системное имя модуля, Массив с набором исполняемых комад или скриптов
* Выход: Массив с набором данных со сценариев

Исполняет все команды содержащиеся в массиве и сохраняет возвращаемые данные в массив

### 4.3 Подстановшик изменений

* Вход: Код шаблона, подготовленный массив с изменнениями, массив с данными
* Выход: Сформированый код шаблона готовый к отресовки

Перебераят переменые с шаблона и сопостовляет их с данными и заменят одно на другое.


### 4.4 Базовый обработчик

* Вход: Имя шаблона, массив с данными
* Выход: Сформированый код шаблона готовый к отресовки

Обьеденяет в себе все выше описаные выше функций.